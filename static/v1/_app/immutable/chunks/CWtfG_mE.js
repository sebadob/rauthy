import{t as k,a as i,d as _e,n as $e,e as O}from"./DiP_w2ew.js";import{j as e,k as J,l as p,p as ve,a6 as oe,a5 as ue,c as r,r as a,a as ne,f as ie,s as b,t as h,a4 as Q,a2 as pe,G as Ue}from"./C0XrmWuC.js";import{e as fe,s as w,r as De}from"./D9PF6UkP.js";import{i as G}from"./656WzJtY.js";import{s as E,a as te,b as Te}from"./1ZS0qFRG.js";import{b as Ce}from"./DplHO1sj.js";import{p as X}from"./DM5IaAvE.js";import{I as Ee}from"./CRtRP45A.js";import{u as de}from"./CIAGEtKU.js";import{i as Ne,g as ze,b as Ae,j as re}from"./Cx6cA6Ki.js";import{I as he}from"./CPhdr6bb.js";import{B as le}from"./Buvqu-RJ.js";import{f as be,d as ge,g as Be}from"./DMieIo7a.js";import{T as Fe}from"./CIpexSXt.js";import{e as je}from"./CJENaP9_.js";import{I as Le}from"./yQnwIU9m.js";import{E as Me}from"./DxvPrxgH.js";import{g as Re}from"./DzmDou2k.js";import{L as ee}from"./Buhh8tsS.js";let me=J(void 0);function Se(){return!e(me)&&Ne()&&be("/auth/v1/users/picture_config").then(j=>{p(me,j.body,!0)}),{get(){return e(me)}}}var Ge=k("<span> </span>"),Ve=k('<img loading="lazy" class="absolute svelte-1e810u7" aria-label="Avatar" alt="" width="100%">'),qe=k('<div class="errLimit svelte-1e810u7"> </div>'),He=k("<div><!></div>"),Ke=k('<div class="relative"><div class="delete svelte-1e810u7"><!></div></div>'),Je=k('<form class="avatar svelte-1e810u7" aria-dropeffect="move" aria-label="Upload"><label class="svelte-1e810u7"><!></label> <input type="file" aria-hidden="true" class="svelte-1e810u7"> <!> <!></form> <!>',1),Oe=k('<span class="avatar svelte-1e810u7"><!></span>'),Qe=k('<div class="container svelte-1e810u7"><!></div>');function Dt(j,t){ve(t,!0);const o=c=>{var u=_e(),v=ie(u);{var B=F=>{var M=Ge(),H=r(M,!0);a(M),h(ae=>{Te(M,1,`absolute font-mono font-${y()} noselect`,"svelte-1e810u7"),w(H,ae)},[()=>t.fallbackCharacters.toUpperCase()]),i(F,M)},D=F=>{var M=Ve();h(()=>E(M,"src",`/auth/v1/users/${t.userId}/picture/${s()}`)),fe("error",M,q),De(M),i(F,M)};G(v,F=>{e(x)||!s()?F(B):F(D,!1)})}i(c,u)};let s=X(t,"pictureId",15),y=X(t,"size",3,"medium");const f=ze(),L="image/png, image/jpeg, image/webp";let z=de(),g=ue(()=>Se().get()),x=J(""),m=J(""),_,I=J(!1),P=J(!1),T=J(void 0),V=ue(R),C=ue(()=>{switch(y()){case"small":return"2.25rem";case"medium":return"3rem";default:return"192px"}});oe(()=>{e(x)&&console.error(e(x))}),oe(()=>{e(m)&&(_&&clearTimeout(_),_=setTimeout(()=>{p(m,"")},5e3))}),oe(()=>{e(T)&&e(T).length>0&&l(e(T))});function R(){return`hsl(${n(t.fallbackCharacters)}, 50%, 50%)`}function q(c){c.type==="error"&&p(x,"Input Error")}function Y(){p(I,!0)}function W(){p(I,!1)}function n(c){let u=[1,255,3,13,19];for(let v=0;v<5;v++){let B=c.charCodeAt(v);if(B)u[v]=B;else break}return(u[0]*(64+u[1])+4*u[0]+(u[2]*u[3]-u[4]))%360}async function N(){if(p(x,""),p(m,""),!s())return;let c=await ge(`/auth/v1/users/${t.userId}/picture/${s()}`);c.error?p(x,c.error.message,!0):s(void 0)}async function l(c){if(p(x,""),p(m,""),!e(g))return;p(P,!0);let u=`/auth/v1/users/${t.userId}/picture`;for(let v of c){if(!L.includes(v.type)){p(x,"Invalid File Format, allowed: "+L);break}if(v.size>e(g).content_len_limit){p(m,`${z.common.maxFileSize}: ${e(g).content_len_limit/1024/1024} MB`);break}let B=new FormData;B.append(v.name,v);let D=await fetch(u,{method:"PUT",headers:{"x-csrf-token":Ae()},body:B});if(D.ok)s(await D.text());else{let F=await D.json();D.status===406?alert("max size"+F.message):p(x,F.message||"Upload Error",!0)}}p(T,void 0),p(P,!1)}var d=Qe(),$=r(d);{var U=c=>{var u=Je(),v=ie(u);let B;var D=r(v);E(D,"for",f),E(D,"aria-controls",f);let F;var M=r(D);Ee(M,{get width(){return e(C)}}),a(D);var H=b(D,2);E(H,"id",f),E(H,"accept",L);var ae=b(H,2);{var we=S=>{var K=qe();let Z;var ce=r(K,!0);a(K),h(()=>{Z=te(K,"",Z,{width:e(C)}),w(ce,e(m))}),i(S,K)};G(ae,S=>{e(m)&&S(we)})}var ye=b(ae,2);o(ye),a(v);var xe=b(v,2);{var ke=S=>{var K=Ke(),Z=r(K),ce=r(Z);le(ce,{invisible:!0,onclick:N,children:(Ie,vt)=>{var se=He(),Pe=r(se);he(Pe,{}),a(se),h(()=>E(se,"title",z.common.delete)),i(Ie,se)},$$slots:{default:!0}}),a(Z),a(K),i(S,K)};G(xe,S=>{y()==="large"&&s()&&S(ke)})}h(()=>{B=te(v,"",B,{"background-color":e(V),width:e(C)}),E(D,"aria-disabled",e(P)),E(D,"data-show",!e(P)&&e(I)),F=te(D,"",F,{width:e(C)}),H.disabled=e(P),E(H,"aria-disabled",e(P))}),fe("mouseenter",v,Y),fe("mouseleave",v,W),Ce(H,()=>e(T),S=>p(T,S)),i(c,u)},A=c=>{var u=Oe();let v;var B=r(u);o(B),a(u),h(()=>v=te(u,"",v,{"background-color":e(V),width:e(C),height:e(C)})),i(c,u)};G($,c=>{e(g)?.upload_allowed&&!t.disableUpload?c(U):c(A,!1)})}a(d),i(j,d),ne()}var We=$e('<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"></path></svg>');function Xe(j,t){let o=X(t,"opacity",3,.9),s=X(t,"width",3,"1.5rem"),y=X(t,"color",3,"currentColor");var f=We();E(f,"stroke-width",2),h(()=>{E(f,"stroke",y()),E(f,"width",s()),E(f,"opacity",o())}),i(j,f)}var Ye=k("<div><!></div>"),Ze=k('<div class="row svelte-165b9or"><div></div> <div class="deleteBtn svelte-165b9or"><!></div></div>'),et=k('<div class="keyContainer svelte-165b9or"><div class="row svelte-165b9or"><span class="label svelte-165b9or"> </span> <div class="nameUv svelte-165b9or"><b> </b> <!></div></div> <div class="row svelte-165b9or"><span class="label svelte-165b9or"> </span> <span class="font-mono"> </span></div> <div class="row svelte-165b9or"><span class="label svelte-165b9or"> </span> <span class="font-mono"> </span></div> <!></div>');function Tt(j,t){ve(t,!0);let o=de();var s=et(),y=r(s),f=r(y),L=r(f,!0);a(f);var z=b(f,2),g=r(z),x=r(g,!0);a(g);var m=b(g,2);{var _=d=>{Fe(d,{get text(){return o.account.userVerifiedTooltip},children:($,U)=>{var A=Ye();te(A,"",{},{"margin-bottom":"-.25rem"});var c=r(A);Xe(c,{width:18,color:"var(--col-acnt)"}),a(A),i($,A)},$$slots:{default:!0}})};G(m,d=>{t.passkey.user_verified&&d(_)})}a(z),a(y);var I=b(y,2),P=r(I),T=r(P,!0);a(P);var V=b(P,2),C=r(V,!0);a(V),a(I);var R=b(I,2),q=r(R),Y=r(q,!0);a(q);var W=b(q,2),n=r(W,!0);a(W),a(R);var N=b(R,2);{var l=d=>{var $=Ze(),U=b(r($),2),A=r(U);le(A,{level:-3,onclick:()=>t.onDelete(t.passkey.name),children:(c,u)=>{Q();var v=O();h(()=>w(v,o.common.delete)),i(c,v)},$$slots:{default:!0}}),a(U),a($),i(d,$)};G(N,d=>{t.showDelete&&d(l)})}a(s),h((d,$)=>{w(L,o.mfa.passkeyName),w(x,t.passkey.name),w(T,o.mfa.registerd),w(C,d),w(Y,o.mfa.lastUsed),w(n,$)},[()=>re(t.passkey.registered),()=>re(t.passkey.last_used)]),i(j,s),ne()}var tt=k('<div class="device-header svelte-9n911e"><div class="device-head font-mono svelte-9n911e"> </div></div>'),rt=k('<div class="saveButton svelte-9n911e"><!></div>'),at=k("<div><!></div>"),st=k("<div> </div>"),ot=k('<div class="device svelte-9n911e"><!> <div class="row svelte-9n911e"><!> <!></div> <!> <!> <!> <!></div>');function it(j,t){ve(t,!0);let o=X(t,"device",15),s=de(),y=J(pe(Ue(()=>o().name)));async function f(){let z={device_id:o().id,name:e(y)},g=await Be(`/auth/v1/users/${t.userId}/devices`,z);g.error?console.error(g.error):o(o().name=e(y),!0)}async function L(){let z={device_id:o().id},g=await ge(`/auth/v1/users/${t.userId}/devices`,z);g.error?console.error(g.error):o(o().refresh_exp=void 0,!0)}Me(j,{summary:x=>{var m=tt(),_=r(m),I=r(_,!0);a(_),a(m),h(()=>w(I,o().name)),i(x,m)},details:x=>{var m=ot(),_=r(m);ee(_,{get label(){return s.account.deviceId},mono:!0,children:(n,N)=>{Q();var l=O();h(()=>w(l,o().id)),i(n,l)},$$slots:{default:!0}});var I=b(_,2),P=r(I);Le(P,{autocomplete:"off",width:"17rem",get label(){return s.account.deviceName},get placeholder(){return s.account.deviceName},onEnter:f,pattern:Re,required:!0,get value(){return e(y)},set value(n){p(y,n,!0)},children:(n,N)=>{Q();var l=O();h(()=>w(l,s.account.deviceName)),i(n,l)},$$slots:{default:!0}});var T=b(P,2);{var V=n=>{var N=rt(),l=r(N);le(l,{onclick:f,children:(d,$)=>{Q();var U=O();h(()=>w(U,s.common.save)),i(d,U)},$$slots:{default:!0}}),a(N),i(n,N)};G(T,n=>{e(y)!==o().name&&n(V)})}a(I);var C=b(I,2);ee(C,{get label(){return s.account.regDate},children:(n,N)=>{Q();var l=O();h(d=>w(l,d),[()=>re(o().created)]),i(n,l)},$$slots:{default:!0}});var R=b(C,2);ee(R,{get label(){return s.account.accessExp},children:(n,N)=>{Q();var l=O();h(d=>w(l,d),[()=>re(o().access_exp)]),i(n,l)},$$slots:{default:!0}});var q=b(R,2);{var Y=n=>{ee(n,{get label(){return s.account.accessRenew},button:l=>{le(l,{get ariaLabel(){return s.common.delete},invisible:!0,onclick:L,children:(d,$)=>{var U=at(),A=r(U);he(A,{}),a(U),h(()=>E(U,"title",s.common.delete)),i(d,U)},$$slots:{default:!0}})},children:(l,d)=>{var $=st(),U=r($,!0);a($),h(A=>w(U,A),[()=>re(o().refresh_exp)]),i(l,$)},$$slots:{button:!0,default:!0}})};G(q,n=>{o().refresh_exp&&n(Y)})}var W=b(q,2);ee(W,{get label(){return s.account.regIp},children:(n,N)=>{Q();var l=O();h(()=>w(l,o().peer_ip)),i(n,l)},$$slots:{default:!0}}),a(m),i(x,m)},$$slots:{summary:!0,details:!0}}),ne()}var lt=k('<div class="head svelte-w0g6eh"> </div> <div class="devices svelte-w0g6eh"><!></div>',1);function Ct(j,t){ve(t,!0);let o=de(),s=J(pe([]));oe(()=>{y()});async function y(){let _=await be(`/auth/v1/users/${t.userId}/devices`);_.body?p(s,_.body,!0):console.error("error fetching devices: "+_.error)}var f=lt(),L=ie(f),z=r(L,!0);a(L);var g=b(L,2),x=r(g);{var m=_=>{var I=_e(),P=ie(I);je(P,19,()=>e(s),T=>T.id,(T,V,C)=>{it(T,{get userId(){return t.userId},get device(){return e(s)[e(C)]},set device(R){e(s)[e(C)]=R}})}),i(_,I)};G(x,_=>{t.userId&&_(m)})}a(g),h(()=>w(z,o?.account.devicesDesc||"Devices linked to this account")),i(j,f),ne()}export{Ct as D,Dt as U,Tt as a};
