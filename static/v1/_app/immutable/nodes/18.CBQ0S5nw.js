import{t as w,a as u,e as J,d as Ge}from"../chunks/DiP_w2ew.js";import{p as se,t as T,a as le,f as Z,s as n,c as l,r as s,j as e,a5 as Y,a4 as H,k as D,a2 as ve,a6 as be,l as o,a1 as Ae,G as Oe}from"../chunks/C0XrmWuC.js";import{s as S}from"../chunks/D9PF6UkP.js";import{i as B}from"../chunks/656WzJtY.js";import{e as Te}from"../chunks/CJENaP9_.js";import{s as Ce,a as qe}from"../chunks/1ZS0qFRG.js";import{g as Fe,f as Ye,d as Je,b as Ee}from"../chunks/DMieIo7a.js";import{C as He}from"../chunks/Bm0BZ32G.js";import{N as Qe}from"../chunks/B-yCTmx-.js";import{u as Xe}from"../chunks/wGIx8MYF.js";import{N as Ze}from"../chunks/DT9JRqIQ.js";import{B as et}from"../chunks/CocMgBlr.js";import{p as j}from"../chunks/DM5IaAvE.js";import{k as tt}from"../chunks/C16yhGNc.js";import{t as rt,s as at,B as ke}from"../chunks/Buvqu-RJ.js";import{g as Ie}from"../chunks/Cx6cA6Ki.js";import{I as Ne}from"../chunks/BfhzFwm0.js";import{F as Me}from"../chunks/CGfBumSq.js";import{u as _e}from"../chunks/TwEUzhIy.js";import{u as we}from"../chunks/CIAGEtKU.js";import{L as $e}from"../chunks/Buhh8tsS.js";import{I as fe}from"../chunks/CNETPzkr.js";import{I as it}from"../chunks/DkfppwSY.js";import{a as X,l as nt,g as ot}from"../chunks/DzmDou2k.js";import{I as F}from"../chunks/yQnwIU9m.js";import{h as pe}from"../chunks/DJG69cfz.js";import{I as st}from"../chunks/Dv2k86Rs.js";import{E as lt}from"../chunks/DxvPrxgH.js";import{T as dt}from"../chunks/CR5YEZgY.js";import{C as ct}from"../chunks/lsYUiROg.js";import{O as ut}from"../chunks/D4-1kQAh.js";var vt=w('<img alt="No Logo Available">');function _t($,i){se(i,!0);var t=vt();Ce(t,"width",20),Ce(t,"height",20),T(f=>Ce(t,"src",f),[()=>`/auth/v1/providers/${i.providerId}/img?${Ie()}}`]),u($,t),le()}var mt=w("<!> <!> <!> <!>",1);function Ue($,i){se(i,!0);let t=j(i,"issuer",15),f=j(i,"authorizationEndpoint",15),h=j(i,"tokenEndpoint",15),y=j(i,"userinfoEndpoint",15);var d=mt(),c=Z(d);F(c,{autocomplete:"off",label:"Issuer URL",placeholder:"Issuer URL",required:!0,pattern:X,get width(){return i.inputWidth},get disabled(){return i.disabled},get value(){return t()},set value(I){t(I)}});var P=n(c,2);F(P,{typ:"url",autocomplete:"off",label:"Authorization Endpoint",placeholder:"Authorization Endpoint",required:!0,pattern:X,get width(){return i.inputWidth},get disabled(){return i.disabled},get value(){return f()},set value(I){f(I)}});var C=n(P,2);F(C,{typ:"url",autocomplete:"off",label:"Token Endpoint",placeholder:"Token Endpoint",required:!0,pattern:X,get width(){return i.inputWidth},get disabled(){return i.disabled},get value(){return h()},set value(I){h(I)}});var r=n(C,2);F(r,{typ:"url",autocomplete:"off",label:"Userinfo Endpoint",placeholder:"Userinfo Endpoint",required:!0,pattern:X,get width(){return i.inputWidth},get disabled(){return i.disabled},get value(){return y()},set value(I){y(I)}}),u($,d),le()}var pt=w('<div class="desc svelte-6fcb3i"><h4 class="svelte-6fcb3i">ID token claim mappings</h4> <p class="svelte-6fcb3i"> </p> <p class="svelte-6fcb3i"><!></p> <p class="svelte-6fcb3i"><!></p> <p class="svelte-6fcb3i"><!></p> <p class="svelte-6fcb3i"><!></p> <p class="svelte-6fcb3i"><!></p></div>');function ft($,i){se(i,!0);let t=_e();var f=pt(),h=n(l(f),2),y=l(h,!0);s(h);var d=n(h,2),c=l(d);pe(c,()=>t.providers.config.jsonPath.p2),s(d);var P=n(d,2),C=l(P);pe(C,()=>t.providers.config.jsonPath.p3),s(P);var r=n(P,2),I=l(r);pe(I,()=>t.providers.config.jsonPath.p4),s(r);var v=n(r,2),x=l(v);pe(x,()=>t.providers.config.jsonPath.p5),s(v);var E=n(v,2),_=l(E);pe(_,()=>t.providers.config.jsonPath.p6),s(E),s(f),T(()=>S(y,t.providers.config.jsonPath.p1)),u($,f),le()}var ht=w('<div class="err"> </div>'),gt=w('<p class="desc svelte-1u8yru7"> </p> <!> <p class="desc svelte-1u8yru7"> </p> <!> <p class="desc svelte-1u8yru7"> </p> <!> <p class="desc svelte-1u8yru7"> </p> <!> <p><!></p> <div class="checkbox"><!></div> <div class="checkbox"><!></div> <!> <!> <p class="desc svelte-1u8yru7"> </p> <!> <!> <p class="desc svelte-1u8yru7"> </p> <!> <!>',1);function De($,i){se(i,!0);let t=j(i,"scope",15),f=j(i,"name",15),h=j(i,"clientId",15),y=j(i,"clientSecret",15),d=j(i,"clientSecretBasic",15),c=j(i,"clientSecretPost",15),P=j(i,"adminClaimPath",15),C=j(i,"adminClaimValue",15),r=j(i,"mfaClaimPath",15),I=j(i,"mfaClaimValue",15),v=_e();var x=gt(),E=Z(x),_=l(E,!0);s(E);var g=n(E,2);F(g,{autocomplete:"off",label:"Scope",placeholder:"openid profile email",required:!0,pattern:nt,get width(){return i.inputWidth},get value(){return t()},set value(b){t(b)}});var m=n(g,2),K=l(m,!0);s(m);var G=n(m,2);F(G,{autocomplete:"off",get label(){return v.providers.config.clientName},get placeholder(){return v.providers.config.clientName},required:!0,pattern:ot,get width(){return i.inputWidth},get value(){return f()},set value(b){f(b)}});var V=n(G,2),U=l(V,!0);s(V);var z=n(V,2);F(z,{autocomplete:"off",label:"Client ID",placeholder:"Client ID",required:!0,pattern:X,get width(){return i.inputWidth},get value(){return h()},set value(b){h(b)}});var W=n(z,2),ee=l(W,!0);s(W);var Q=n(W,2);const ae=Y(()=>!i.usePKCE);st(Q,{autocomplete:"off",label:"Client Secret",placeholder:"Client Secret",maxLength:256,get errMsg(){return v.providers.config.errConfidential},get required(){return e(ae)},get width(){return i.inputWidth},get value(){return y()},set value(b){y(b)}});var ie=n(Q,2),L=l(ie);pe(L,()=>v.providers.config.descAuthMethod),s(ie);var R=n(ie,2),p=l(R);fe(p,{ariaLabel:"client_secret_basic",get checked(){return d()},set checked(b){d(b)},children:(b,re)=>{H();var ue=J("client_secret_basic");u(b,ue)},$$slots:{default:!0}}),s(R);var M=n(R,2),de=l(M);fe(de,{ariaLabel:"client_secret_post",get checked(){return c()},set checked(b){c(b)},children:(b,re)=>{H();var ue=J("client_secret_post");u(b,ue)},$$slots:{default:!0}}),s(M);var te=n(M,2);{var ne=b=>{var re=ht(),ue=l(re,!0);s(re),T(()=>S(ue,v.providers.config.errNoAuthMethod)),rt(3,re,()=>at,()=>({duration:150})),u(b,re)};B(te,b=>{!i.usePKCE&&!d()&&!c()&&b(ne)})}var a=n(te,2);ft(a,{});var q=n(a,2),N=l(q,!0);s(q);var ce=n(q,2);F(ce,{autocomplete:"off",get label(){return v.providers.config.pathAdminClaim},placeholder:"$.roles.*",pattern:X,get width(){return i.inputWidth},get value(){return P()},set value(b){P(b)}});var Pe=n(ce,2);const xe=Y(()=>!!P());F(Pe,{autocomplete:"off",get label(){return v.providers.config.valueAdminClaim},placeholder:"rauthy_admin",pattern:X,get width(){return i.inputWidth},get required(){return e(xe)},get value(){return C()},set value(b){C(b)}});var he=n(Pe,2),A=l(he,!0);s(he);var O=n(he,2);F(O,{autocomplete:"off",get label(){return v.providers.config.pathMfaClaim},placeholder:"$.amr.*",pattern:X,get width(){return i.inputWidth},get value(){return r()},set value(b){r(b)}});var oe=n(O,2);const me=Y(()=>!!r());F(oe,{autocomplete:"off",get label(){return v.providers.config.valueMfaClaim},placeholder:"mfa",pattern:X,get width(){return i.inputWidth},get required(){return e(me)},get value(){return I()},set value(b){I(b)}}),T(()=>{S(_,v.providers.config.descScope),S(K,v.providers.config.descClientName),S(U,v.providers.config.descClientId),S(ee,v.providers.config.descClientSecret),S(N,v.providers.config.mapUser),S(A,v.providers.config.mapMfa)}),u($,x),le()}var bt=w('<div class="svelte-jts2zb"><!></div>'),kt=w('<span class="err"> </span>'),Pt=w('<!> <div></div> <div class="checkbox svelte-jts2zb"><!></div> <!> <div class="checkbox svelte-jts2zb"><!></div> <!> <div class="logo svelte-jts2zb"><!> <!></div> <div class="flex gap-05"><!> <!> <!></div>',1),Ct=w('<div class="container svelte-jts2zb"><!></div>');function xt($,i){se(i,!0);let t=j(i,"provider",15),f=we(),h=_e();const y="min(calc(100dvw - .5rem), 30rem)";let d=!1,c=D(""),P=D(!1),C=D(ve(Ie()));be(()=>{t().id&&(t(t().client_secret=t().client_secret||"",!0),t(t().admin_claim_path=t().admin_claim_path||"",!0),t(t().admin_claim_value=t().admin_claim_value||"",!0),t(t().mfa_claim_path=t().mfa_claim_path||"",!0),t(t().mfa_claim_value=t().mfa_claim_value||"",!0))}),be(()=>{t().scope&&t(t().scope=t().scope.replaceAll("+"," "),!0)});async function r(E,_){if(o(c,""),t().client_secret&&!(t().client_secret_basic||t().client_secret_post)){o(c,h.providers.config.errNoAuthMethod,!0);return}if(!t().use_pkce&&!t().client_secret){o(c,h.providers.config.errConfidential,!0);return}let g={name:t().name,typ:t().typ,enabled:t().enabled,issuer:t().issuer,authorization_endpoint:t().authorization_endpoint,token_endpoint:t().token_endpoint,userinfo_endpoint:t().userinfo_endpoint,use_pkce:t().use_pkce,client_secret_basic:t().client_secret_basic,client_secret_post:t().client_secret_post,client_id:t().client_id,client_secret:t().client_secret||void 0,scope:t().scope.trim(),admin_claim_path:t().admin_claim_path||void 0,admin_claim_value:t().admin_claim_value||void 0,mfa_claim_path:t().mfa_claim_path||void 0,mfa_claim_value:t().mfa_claim_value||void 0},m=await Fe(E.action,g);m.error?o(c,m.error.message,!0):(o(P,!0),i.onSave(),setTimeout(()=>{o(P,!1)},3e3))}var I=Ct(),v=l(I);const x=Y(()=>`/auth/v1/providers/${t().id}`);Me(v,{get action(){return e(x)},onSubmit:r,children:(E,_)=>{var g=Pt(),m=Z(g);$e(m,{label:"ID",mono:!0,children:(a,q)=>{H();var N=J();T(()=>S(N,t().id)),u(a,N)},$$slots:{default:!0}});var K=n(m,2);qe(K,"",{},{height:".15rem"});var G=n(K,2),V=l(G);fe(V,{get ariaLabel(){return h.common.enabled},get checked(){return t().enabled},set checked(a){t(t().enabled=a,!0)},children:(a,q)=>{H();var N=J();T(()=>S(N,h.common.enabled)),u(a,N)},$$slots:{default:!0}}),s(G);var U=n(G,2);Ue(U,{inputWidth:y,get issuer(){return t().issuer},set issuer(a){t(t().issuer=a,!0)},get authorizationEndpoint(){return t().authorization_endpoint},set authorizationEndpoint(a){t(t().authorization_endpoint=a,!0)},get tokenEndpoint(){return t().token_endpoint},set tokenEndpoint(a){t(t().token_endpoint=a,!0)},get userinfoEndpoint(){return t().userinfo_endpoint},set userinfoEndpoint(a){t(t().userinfo_endpoint=a,!0)}});var z=n(U,2),W=l(z);fe(W,{ariaLabel:"PKCE",get checked(){return t().use_pkce},set checked(a){t(t().use_pkce=a,!0)},children:(a,q)=>{H();var N=J("PKCE");u(a,N)},$$slots:{default:!0}}),s(z);var ee=n(z,2);De(ee,{get usePKCE(){return t().use_pkce},inputWidth:y,get scope(){return t().scope},set scope(a){t(t().scope=a,!0)},get name(){return t().name},set name(a){t(t().name=a,!0)},get clientId(){return t().client_id},set clientId(a){t(t().client_id=a,!0)},get clientSecret(){return t().client_secret},set clientSecret(a){t(t().client_secret=a,!0)},get clientSecretBasic(){return t().client_secret_basic},set clientSecretBasic(a){t(t().client_secret_basic=a,!0)},get clientSecretPost(){return t().client_secret_post},set clientSecretPost(a){t(t().client_secret_post=a,!0)},get adminClaimPath(){return t().admin_claim_path},set adminClaimPath(a){t(t().admin_claim_path=a,!0)},get adminClaimValue(){return t().admin_claim_value},set adminClaimValue(a){t(t().admin_claim_value=a,!0)},get mfaClaimPath(){return t().mfa_claim_path},set mfaClaimPath(a){t(t().mfa_claim_path=a,!0)},get mfaClaimValue(){return t().mfa_claim_value},set mfaClaimValue(a){t(t().mfa_claim_value=a,!0)}});var Q=n(ee,2),ae=l(Q);tt(ae,()=>e(C),a=>{var q=bt(),N=l(q);_t(N,{get providerId(){return t().id}}),s(q),u(a,q)});var ie=n(ae,2);const L=Y(()=>`/auth/v1/providers/${t().id}/img`);it(ie,{method:"PUT",get url(){return e(L)},fileName:"logo",onSuccess:()=>o(C,Ie(),!0)}),s(Q);var R=n(Q,2),p=l(R);ke(p,{type:"submit",get isLoading(){return d},children:(a,q)=>{H();var N=J();T(()=>S(N,f.common.save)),u(a,N)},$$slots:{default:!0}});var M=n(p,2);{var de=a=>{Ne(a,{})};B(M,a=>{e(P)&&a(de)})}var te=n(M,2);{var ne=a=>{var q=kt(),N=l(q,!0);s(q),T(()=>S(N,e(c))),u(a,q)};B(te,a=>{e(c)&&a(ne)})}s(R),u(E,g)},$$slots:{default:!0}}),s(I),u($,I),le()}var yt=w('<div class="user svelte-1vu6qeb"> <span class="muted font-mono svelte-1vu6qeb"> </span></div>'),St=w('<div class="forceDelete svelte-1vu6qeb"> </div>'),Et=w('<p class="err"><b> </b></p> <p> </p> <!> <p> </p> <!> <!>',1),It=w("<p> </p> <!>",1),wt=w('<div class="err"> </div>'),Lt=w('<div class="container svelte-1vu6qeb"><!> <!></div>');function zt($,i){se(i,!0);let t=we(),f=_e(),h=D(!0),y=D(""),d=D(!1),c=D(ve([]));Ae(async()=>{let _=await Ye(`/auth/v1/providers/${i.provider.id}/delete_safe`);_.status===406&&_.error&&o(c,_.error,!0),o(h,!1)});async function P(){o(y,""),o(h,!0);let _=await Je(`/auth/v1/providers/${i.provider.id}`);_.error?o(y,_.error.message,!0):i.onSave(),o(h,!1)}var C=Lt(),r=l(C);{var I=_=>{var g=Et(),m=Z(g),K=l(m),G=l(K,!0);s(K),s(m);var V=n(m,2),U=l(V,!0);s(V);var z=n(V,2);lt(z,{summary:p=>{H();var M=J();T(()=>S(M,f.providers.delete.linkedUsers)),u(p,M)},details:p=>{var M=Ge(),de=Z(M);Te(de,17,()=>e(c),te=>te.id,(te,ne)=>{var a=yt(),q=l(a),N=n(q),ce=l(N);s(N),s(a),T(()=>{S(q,`${e(ne).email??""} `),S(ce,`/ ${e(ne).id??""}`)}),u(te,a)}),u(p,M)},$$slots:{summary:!0,details:!0}});var W=n(z,2),ee=l(W,!0);s(W);var Q=n(W,2);fe(Q,{get ariaLabel(){return f.providers.delete.forceDelete},get checked(){return e(d)},set checked(L){o(d,L,!0)},children:(L,R)=>{var p=St(),M=l(p,!0);s(p),T(()=>S(M,f.providers.delete.forceDelete)),u(L,p)},$$slots:{default:!0}});var ae=n(Q,2);{var ie=L=>{ke(L,{level:-1,onclick:P,get isLoading(){return e(h)},children:(R,p)=>{H();var M=J();T(()=>S(M,t.common.delete)),u(R,M)},$$slots:{default:!0}})};B(ae,L=>{e(d)&&L(ie)})}T(()=>{S(G,f.providers.delete.isInUse1),S(U,f.providers.delete.isInUse2),S(ee,f.providers.delete.areYouSure)}),u(_,g)},v=_=>{var g=It(),m=Z(g),K=l(m,!0);s(m);var G=n(m,2);ke(G,{level:-1,onclick:P,get isLoading(){return e(h)},children:(V,U)=>{H();var z=J();T(()=>S(z,t.common.delete)),u(V,z)},$$slots:{default:!0}}),T(()=>S(K,f.providers.delete.areYouSure)),u(_,g)};B(r,_=>{e(c).length>0?_(I):_(v,!1)})}var x=n(r,2);{var E=_=>{var g=wt(),m=l(g,!0);s(g),T(()=>S(m,e(y))),u(_,g)};B(x,_=>{e(y)&&_(E)})}s(C),u($,C),le()}var At=w('<div class="flex"><!></div> <!>',1);function Tt($,i){se(i,!0);let t=j(i,"provider",15),f=j(i,"onSave",15),h=_e();const y=[h.tabs.config,h.tabs.delete];let d=D(ve(y[0]));var c=At(),P=Z(c),C=l(P);dt(C,{tabs:y,get selected(){return e(d)},set selected(x){o(d,x,!0)}}),s(P);var r=n(P,2);{var I=x=>{xt(x,{get provider(){return t()},set provider(E){t(E)},get onSave(){return f()},set onSave(E){f(E)}})},v=(x,E)=>{{var _=g=>{zt(g,{get provider(){return t()},get onSave(){return f()},set onSave(m){f(m)}})};B(x,g=>{e(d)===h.tabs.delete&&g(_)},E)}};B(r,x=>{e(d)===h.tabs.config?x(I):x(v,!1)})}u($,c),le()}var qt=w('<!> <div class="checkbox svelte-qeky4o"><!></div> <!>',1),Nt=w('<div class="err"> </div>'),Mt=w('<!> <div class="flex gap-05"><!> <!> <!> <!></div>',1),$t=w('<div class="container svelte-qeky4o"><!> <div></div> <!></div>');function Ut($,i){se(i,!0);let t=we(),f=_e();const h="min(calc(100dvw - 1.75rem), 30rem)";let y=D(!1),d=D(""),c=D(!1),P=D(!1),C=D(ve({issuer:"",metadata_url:""})),r=D(ve({enabled:!0,typ:"oidc",issuer:"",authorization_endpoint:"",token_endpoint:"",token_auth_method_basic:!1,userinfo_endpoint:"",use_pkce:!0,client_secret_basic:!0,client_secret_post:!1,name:"",client_id:"",client_secret:"",scope:"",admin_claim_path:"",admin_claim_value:"",mfa_claim_path:"",mfa_claim_value:""})),I=["OIDC","Auto","Custom","Github","Google"],v=D(ve(I[0])),x=Y(()=>e(v)==="Auto"),E=Y(()=>e(v)==="Custom"),_=Y(()=>e(v)==="OIDC"),g=Y(()=>!e(x)&&!e(E)&&!e(_)),m=Y(()=>!(e(g)||e(E)||e(c)));const K="/auth/v1/providers/lookup";let G=Y(()=>e(m)?K:"/auth/v1/providers/create");be(()=>{if(e(v))switch(o(c,!1),o(C,{issuer:"",metadata_url:""},!0),e(v)){case"Github":o(r,{enabled:!0,issuer:"github.com",typ:"github",authorization_endpoint:"https://github.com/login/oauth/authorize",token_endpoint:"https://github.com/login/oauth/access_token",client_secret_basic:!0,client_secret_post:!0,userinfo_endpoint:"https://api.github.com/user",use_pkce:!1,name:"Github",client_id:"",client_secret:"",scope:"user:email",admin_claim_path:"",admin_claim_value:"",mfa_claim_path:"$.two_factor_authentication",mfa_claim_value:"true"},!0),o(c,!0);break;case"Google":o(C,{issuer:"accounts.google.com",metadata_url:""},!0),Oe(()=>{z(K)});break;default:o(r,{enabled:!0,issuer:"",typ:"oidc",authorization_endpoint:"",token_endpoint:"",client_secret_basic:!0,client_secret_post:!1,userinfo_endpoint:"",use_pkce:!0,name:"",client_id:"",client_secret:"",scope:"",admin_claim_path:"",admin_claim_value:"",mfa_claim_path:"",mfa_claim_value:""},!0)}}),be(()=>{e(P)&&setTimeout(()=>{i.onSave(),W()},1500)});async function V(L,R){e(m)?await z(L.action):await U(L.action)}async function U(L){if(e(r).client_secret&&!(e(r).client_secret_basic||e(r).client_secret_post)){o(d,f.providers.config.errNoAuthMethod,!0);return}if(!e(r).use_pkce&&!e(r).client_secret){o(d,f.providers.config.errConfidential,!0);return}o(d,""),o(y,!0);let R={name:e(r).name,typ:e(x)?"custom":e(v).toLowerCase(),enabled:e(r).enabled,issuer:e(r).issuer,authorization_endpoint:e(r).authorization_endpoint,token_endpoint:e(r).token_endpoint,userinfo_endpoint:e(r).userinfo_endpoint,use_pkce:e(r).use_pkce,client_secret_basic:e(r).client_secret_basic,client_secret_post:e(r).client_secret_post,client_id:e(r).client_id,client_secret:e(r).client_secret,scope:e(r).scope.trim(),admin_claim_path:e(r).admin_claim_path||void 0,admin_claim_value:e(r).admin_claim_value||void 0,mfa_claim_path:e(r).mfa_claim_path||void 0,mfa_claim_value:e(r).mfa_claim_value||void 0},p=await Ee(L,R);p.error?p.error.message.includes("InvalidCertificate")?o(d,"Insecure connection not allowed"):o(d,p.error.message,!0):o(P,!0),o(y,!1)}async function z(L){if(!e(C).issuer&&!e(C).metadata_url){o(d,"Provide at least one of Issuer / Metadata URL");return}o(d,""),o(y,!0);let R={issuer:e(C).issuer||void 0,metadata_url:e(C).metadata_url||void 0},p=await Ee(L,R);p.body?(e(r).issuer=p.body.issuer,e(r).authorization_endpoint=p.body.authorization_endpoint,e(r).token_endpoint=p.body.token_endpoint,e(r).userinfo_endpoint=p.body.userinfo_endpoint,e(r).client_secret_basic=p.body.client_secret_basic,e(r).client_secret_post=p.body.client_secret_post,e(r).use_pkce=p.body.use_pkce,e(r).client_secret_basic=p.body.client_secret_basic,e(r).client_secret_post=!p.body.client_secret_basic&&p.body.client_secret_post,e(r).scope=p.body.scope,o(c,!0)):p.error&&(p.error.message.includes("InvalidCertificate")?o(d,"Insecure connection not allowed"):o(d,p.error.message,!0)),o(y,!1)}function W(){o(C,{issuer:"",metadata_url:""},!0),o(r,{enabled:!0,issuer:"",typ:"oidc",authorization_endpoint:"",token_endpoint:"",userinfo_endpoint:"",use_pkce:!0,name:"",client_id:"",client_secret_basic:!0,client_secret_post:!1,scope:"",admin_claim_path:"",admin_claim_value:"",mfa_claim_path:"",mfa_claim_value:""},!0),o(P,!1),o(c,!1)}var ee=$t(),Q=l(ee);ut(Q,{ariaLabel:"Select Mode",options:I,get value(){return e(v)},set value(L){o(v,L,!0)}});var ae=n(Q,2);qe(ae,"",{},{height:".5rem"});var ie=n(ae,2);Me(ie,{get action(){return e(G)},onSubmit:V,children:(L,R)=>{var p=Mt(),M=Z(p);{var de=A=>{F(A,{name:"issuer",label:"Issuer URL",placeholder:"Issuer URL",width:h,required:!0,pattern:X,get value(){return e(C).issuer},set value(O){e(C).issuer=O}})},te=(A,O)=>{{var oe=b=>{F(b,{typ:"url",name:"metadata",label:"Metadata URL",placeholder:".../.well-known/openid-configuration",width:h,required:!0,pattern:X,get value(){return e(C).metadata_url},set value(re){e(C).metadata_url=re}})},me=(b,re)=>{{var ue=ye=>{var Le=qt(),ze=Z(Le);Ue(ze,{inputWidth:h,get disabled(){return e(c)},get issuer(){return e(r).issuer},set issuer(k){e(r).issuer=k},get authorizationEndpoint(){return e(r).authorization_endpoint},set authorizationEndpoint(k){e(r).authorization_endpoint=k},get tokenEndpoint(){return e(r).token_endpoint},set tokenEndpoint(k){e(r).token_endpoint=k},get userinfoEndpoint(){return e(r).userinfo_endpoint},set userinfoEndpoint(k){e(r).userinfo_endpoint=k}});var Se=n(ze,2),Ve=l(Se);{var We=k=>{$e(k,{label:"PKCE",children:(ge,Ke)=>{ct(ge,{get checked(){return e(r).use_pkce}})},$$slots:{default:!0}})},je=k=>{fe(k,{ariaLabel:"PKCE",get checked(){return e(r).use_pkce},set checked(ge){e(r).use_pkce=ge},children:(ge,Ke)=>{H();var Re=J("PKCE");u(ge,Re)},$$slots:{default:!0}})};B(Ve,k=>{e(c)?k(We):k(je,!1)})}s(Se);var Be=n(Se,2);De(Be,{get usePKCE(){return e(r).use_pkce},inputWidth:h,get scope(){return e(r).scope},set scope(k){e(r).scope=k},get name(){return e(r).name},set name(k){e(r).name=k},get clientId(){return e(r).client_id},set clientId(k){e(r).client_id=k},get clientSecret(){return e(r).client_secret},set clientSecret(k){e(r).client_secret=k},get clientSecretBasic(){return e(r).client_secret_basic},set clientSecretBasic(k){e(r).client_secret_basic=k},get clientSecretPost(){return e(r).client_secret_post},set clientSecretPost(k){e(r).client_secret_post=k},get adminClaimPath(){return e(r).admin_claim_path},set adminClaimPath(k){e(r).admin_claim_path=k},get adminClaimValue(){return e(r).admin_claim_value},set adminClaimValue(k){e(r).admin_claim_value=k},get mfaClaimPath(){return e(r).mfa_claim_path},set mfaClaimPath(k){e(r).mfa_claim_path=k},get mfaClaimValue(){return e(r).mfa_claim_value},set mfaClaimValue(k){e(r).mfa_claim_value=k}}),u(ye,Le)};B(b,ye=>{(e(g)||e(E)||e(c))&&ye(ue)},re)}};B(A,b=>{e(x)&&!e(c)?b(oe):b(me,!1)},O)}};B(M,A=>{e(_)&&!e(c)?A(de):A(te,!1)})}var ne=n(M,2),a=l(ne);ke(a,{type:"submit",get isLoading(){return e(y)},children:(A,O)=>{H();var oe=J();T(()=>S(oe,e(m)?f.providers.config.lookup:t.common.save)),u(A,oe)},$$slots:{default:!0}});var q=n(a,2);{var N=A=>{ke(A,{level:3,onclick:W,get isLoading(){return e(y)},children:(O,oe)=>{H();var me=J();T(()=>S(me,f.common.reset)),u(O,me)},$$slots:{default:!0}})};B(q,A=>{e(m)||A(N)})}var ce=n(q,2);{var Pe=A=>{Ne(A,{})};B(ce,A=>{e(P)&&A(Pe)})}var xe=n(ce,2);{var he=A=>{var O=Nt(),oe=l(O,!0);s(O),T(()=>S(oe,e(d))),u(A,O)};B(xe,A=>{e(d)&&A(he)})}s(ne),u(L,p)},$$slots:{default:!0}}),s(ee),u($,ee),le()}var Dt=w('<div class="providersList svelte-1gn8otg"></div>'),Vt=w('<div class="err"> </div>'),Wt=w('<div id="federation"><!></div> <!>',1),jt=w("<!> <!>",1);function Bt($,i){se(i,!0);let t=_e(),f=D(void 0),h=Xe("pid"),y=D(""),d=D(ve([])),c=D(void 0);Ae(()=>{P()}),be(()=>{o(c,e(d).find(x=>x.id===h.get()),!0)});async function P(){let x=await Ee("/auth/v1/providers");x.body?o(d,x.body,!0):o(y,x.error?.message||"Error",!0)}function C(){h.set(void 0),e(f)?.(),P()}var r=jt(),I=Z(r);Qe(I,{width:"11rem",buttonTilesAriaControls:"federation",paddingTop:"6.65rem",buttonTiles:E=>{var _=Dt();Te(_,21,()=>e(d),g=>g.id,(g,m,K,G)=>{const V=Y(()=>h.get()===e(m).id);Ze(g,{onclick:()=>h.set(e(m).id),get selected(){return e(V)},children:(U,z)=>{H();var W=J();T(()=>S(W,e(m).name)),u(U,W)}})}),s(_),u(E,_)},children:(E,_)=>{const g=Y(()=>e(d).length===0?1:2);et(E,{get level(){return e(g)},get closeModal(){return e(f)},set closeModal(m){o(f,m,!0)},children:(m,K)=>{Ut(m,{onSave:C})},$$slots:{default:!0}})},$$slots:{buttonTiles:!0,default:!0}});var v=n(I,2);He(v,{children:(x,E)=>{var _=Wt(),g=Z(_),m=l(g);{var K=U=>{Tt(U,{onSave:P,get provider(){return e(c)},set provider(z){o(c,z,!0)}})};B(m,U=>{e(c)&&U(K)})}s(g);var G=n(g,2);{var V=U=>{var z=Vt(),W=l(z,!0);s(z),T(()=>S(W,e(y))),u(U,z)};B(G,U=>{e(y)&&U(V)})}T(()=>Ce(g,"aria-label",t.common.details)),u(x,_)}}),u($,r),le()}function kr($){Bt($,{})}export{kr as component};
