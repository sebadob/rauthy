import{t as y,e as V,a as i,d as ae}from"../chunks/DVyqXkF9.js";import{p as W,a6 as j,f as E,l as s,k as x,j as e,s as R,t as B,c as M,a as H,a4 as z,r as T,a2 as G,a5 as U,a1 as oe}from"../chunks/DXTz3Rbt.js";import{s as D}from"../chunks/BLUcFBb0.js";import{i as L}from"../chunks/Dnzfvyee.js";import{e as se}from"../chunks/Dus-q-Em.js";import{u as J}from"../chunks/T3uKKWzz.js";import{B as le}from"../chunks/CVyulMm_.js";import{C as ne}from"../chunks/CL_mTQmm.js";import{N as ie}from"../chunks/NPevBcaT.js";import{N as de}from"../chunks/x_khJbtH.js";import{O as ue}from"../chunks/99krErCG.js";import{b as ve,d as me,c as fe,f as ce}from"../chunks/QS8tP13U.js";import{u as _e}from"../chunks/C7g8-Uli.js";import{B as Y}from"../chunks/BaLU91-Z.js";import{I as Z}from"../chunks/DVvDmFQc.js";import{f as ee}from"../chunks/DzmDou2k.js";import{F as re}from"../chunks/BHicDA9d.js";import{u as X}from"../chunks/pXVVLMtZ.js";import{T as ge}from"../chunks/Uvg4PFWU.js";import{h as te}from"../chunks/CP6_I6cz.js";import{I as he}from"../chunks/COZs6rVX.js";import{L as pe}from"../chunks/BlWtnSFg.js";var be=y('<div class="err"> </div>'),xe=y("<!> <!> <!>",1),ye=y('<div class="container svelte-s1196z"><!></div>');function Pe(N,a){W(a,!0);let I=X(),m=J(),d=x(void 0),o=x(""),f=x("");j(()=>{requestAnimationFrame(()=>{e(d)?.focus()})});async function c(h,v){if(a.roles.find(P=>P.name===e(f))){s(o,m.common.nameExistsAlready,!0);return}s(o,"");let n={role:e(f)},t=await ve(h.action,n);t.body?a.onSave(t.body.id):s(o,t.error?.message||"Error",!0)}var g=ye(),C=M(g);re(C,{action:"/auth/v1/roles",onSubmit:c,children:(h,v)=>{var n=xe(),t=E(n);Z(t,{autocomplete:"off",get label(){return m.roles.name},get placeholder(){return m.roles.name},required:!0,pattern:ee,get ref(){return e(d)},set ref(p){s(d,p,!0)},get value(){return e(f)},set value(p){s(f,p,!0)}});var P=R(t,2);Y(P,{type:"submit",children:(p,S)=>{z();var A=V();B(()=>D(A,I.common.save)),i(p,A)},$$slots:{default:!0}});var O=R(P,2);{var $=p=>{var S=be(),A=M(S,!0);T(S),B(()=>D(A,e(o))),i(p,S)};L(O,p=>{e(o)&&p($)})}i(h,n)},$$slots:{default:!0}}),T(g),i(N,g),H()}var Se=y("<p><!></p>"),we=y('<div class="flex gap-05"><!> <!></div>'),Ae=y('<div class="err"> </div>'),Ce=y("<!> <!> <!> <!>",1);function Re(N,a){W(a,!0);let I=X(),m=J(),d=x(""),o=x(!1),f=U(()=>a.role.name==="rauthy_admin"),c=x(G(a.role.name));j(()=>{a.role.id&&s(c,a.role.name,!0)});async function g(h,v){if(s(d,""),e(c)!==a.role.name&&a.roles.find(P=>P.name===e(c))){s(d,m.common.nameExistsAlready,!0);return}let n={role:e(c)},t=await me(h.action,n);t.error?s(d,t.error.message,!0):(s(o,!0),a.onSave(),setTimeout(()=>{s(o,!1)},2e3))}const C=U(()=>`/auth/v1/roles/${a.role.id}`);re(N,{get action(){return e(C)},onSubmit:g,children:(h,v)=>{var n=Ce(),t=E(n);pe(t,{label:"ID",mono:!0,children:(r,l)=>{z();var u=V();B(()=>D(u,a.role.id)),i(r,u)},$$slots:{default:!0}});var P=R(t,2);Z(P,{autocomplete:"off",get label(){return m.roles.name},get placeholder(){return m.roles.name},get disabled(){return e(f)},width:"14.5rem",required:!0,pattern:ee,get value(){return e(c)},set value(r){s(c,r,!0)}});var O=R(P,2);{var $=r=>{var l=Se(),u=M(l);te(u,()=>m.roles.adminNoMod),T(l),i(r,l)},p=r=>{var l=we(),u=M(l);Y(u,{type:"submit",children:(F,q)=>{z();var w=V();B(()=>D(w,I.common.save)),i(F,w)},$$slots:{default:!0}});var _=R(u,2);{var b=F=>{he(F,{})};L(_,F=>{e(o)&&F(b)})}T(l),i(r,l)};L(O,r=>{e(f)?r($):r(p,!1)})}var S=R(O,2);{var A=r=>{var l=Ae(),u=M(l,!0);T(l),B(()=>D(u,e(d))),i(r,l)};L(S,r=>{e(d)&&r(A)})}i(h,n)},$$slots:{default:!0}}),H()}var Te=y("<p><!></p>"),Ne=y('<div class="err"> </div>'),Ie=y("<p> </p> <!> <!>",1);function Oe(N,a){W(a,!0);let I=X(),m=J(),d=x(""),o=U(()=>a.role.name==="rauthy_admin");async function f(){s(d,"");let v=await fe(`/auth/v1/roles/${a.role.id}`);v.error?s(d,v.error.message,!0):a.onSave()}var c=ae(),g=E(c);{var C=v=>{var n=Te(),t=M(n);te(t,()=>m.roles.adminNoMod),T(n),i(v,n)},h=v=>{var n=Ie(),t=E(n),P=M(t,!0);T(t);var O=R(t,2);Y(O,{level:-1,onclick:f,children:(S,A)=>{z();var r=V();B(()=>D(r,I.common.delete)),i(S,r)},$$slots:{default:!0}});var $=R(O,2);{var p=S=>{var A=Ne(),r=M(A,!0);T(A),B(()=>D(r,e(d))),i(S,A)};L($,S=>{e(d)&&S(p)})}B(()=>D(P,m.roles.delete1)),i(v,n)};L(g,v=>{e(o)?v(C):v(h,!1)})}i(N,c),H()}var $e=y('<div class="flex"><!></div> <!>',1);function Fe(N,a){W(a,!0);let I=X(),m=J();const d=[m.nav.config,I.common.delete];let o=x(G(d[0])),f=x(void 0);j(()=>{a.role.id&&requestAnimationFrame(()=>{e(f)?.()})});var c=$e(),g=E(c),C=M(g);ge(C,{tabs:d,get selected(){return e(o)},set selected(t){s(o,t,!0)},get focusFirst(){return e(f)},set focusFirst(t){s(f,t,!0)}}),T(g);var h=R(g,2);{var v=t=>{Re(t,{get role(){return a.role},get roles(){return a.roles},get onSave(){return a.onSave}})},n=(t,P)=>{{var O=$=>{Oe($,{get role(){return a.role},get onSave(){return a.onSave}})};L(t,$=>{e(o)===I.common.delete&&$(O)},P)}};L(h,t=>{e(o)===m.nav.config?t(v):t(n,!1)})}i(N,c),H()}var Me=y('<div class="rolesList svelte-nkhlm9"></div>'),ke=y("<!> <!>",1),Be=y('<div class="err"> </div>'),De=y('<!> <div id="groups"><!></div>',1),Le=y("<!> <!>",1);function Ee(N,a){W(a,!0);let I=J(),m=x(void 0),d=x(""),o=x(G([])),f=x(G([])),c=x(void 0),g=_e("rid");const C=[I.common.name,"ID"];let h=x(G(C[0])),v=x("");const n=[I.common.name,"ID"];oe(()=>{t()}),j(()=>{s(c,e(o).find(r=>r.id===g.get()),!0)}),j(()=>{let r=e(v).toLowerCase();r?e(h)===C[0]?s(f,e(o).filter(l=>l.name?.toLowerCase().includes(r)),!0):e(h)===C[1]&&s(f,e(o).filter(l=>l.id.toLowerCase().includes(r)),!0):s(f,e(o),!0)});async function t(){let r=await ce("/auth/v1/roles");r.body?s(o,r.body,!0):s(d,r.error?.message||"Error",!0)}function P(r,l){let u=l==="up";r===n[0]?e(o).sort((_,b)=>u?_.name.localeCompare(b.name):b.name.localeCompare(_.name)):r===n[1]&&e(o).sort((_,b)=>u?_.id.localeCompare(b.id):b.id.localeCompare(_.id))}function O(){t()}async function $(r){e(m)?.(),await t(),g.set(r)}var p=Le(),S=E(p);de(S,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:l=>{var u=Me();se(u,21,()=>e(f),_=>_.id,(_,b,F,q)=>{const w=U(()=>g.get()===e(b).id);ie(_,{onclick:()=>g.set(e(b).id),get selected(){return e(w)},children:(k,K)=>{z();var Q=V();B(()=>D(Q,e(b).name)),i(k,Q)}})}),T(u),i(l,u)},children:(l,u)=>{var _=ke(),b=E(_);const F=U(()=>e(o).length===0?1:2);le(b,{get level(){return e(F)},alignRight:!0,get closeModal(){return e(m)},set closeModal(w){s(m,w,!0)},children:(w,k)=>{Pe(w,{onSave:$,get roles(){return e(o)}})},$$slots:{default:!0}});var q=R(b,2);ue(q,{searchOptions:C,orderOptions:n,onChangeOrder:P,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(h)},set searchOption(w){s(h,w,!0)},get value(){return e(v)},set value(w){s(v,w,!0)}}),i(l,_)},$$slots:{buttonTiles:!0,default:!0}});var A=R(S,2);ne(A,{children:(r,l)=>{var u=De(),_=E(u);{var b=k=>{var K=Be(),Q=M(K,!0);T(K),B(()=>D(Q,e(d))),i(k,K)};L(_,k=>{e(d)&&k(b)})}var F=R(_,2),q=M(F);{var w=k=>{Fe(k,{get role(){return e(c)},get roles(){return e(o)},onSave:O})};L(q,k=>{e(c)&&k(w)})}T(F),i(r,u)}}),i(N,p),H()}function ir(N){Ee(N,{})}export{ir as component};
