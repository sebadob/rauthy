import{t as L,a as k,e as U,d as Pe}from"../chunks/DVyqXkF9.js";import{p as X,a2 as j,a6 as W,s as c,c as v,a7 as me,a as Z,a4 as B,t as D,j as e,a5 as F,r as n,k as T,l as s,f as J,a1 as ge}from"../chunks/DXTz3Rbt.js";import{s as E,o as Se}from"../chunks/BLUcFBb0.js";import{i as R}from"../chunks/Dnzfvyee.js";import{e as he,i as Te}from"../chunks/Dus-q-Em.js";import{s as ne,a as Ae,e as ze,S as Ce}from"../chunks/B28jQOFH.js";import{d as ke,c as Le,b as Ke,f as De}from"../chunks/QS8tP13U.js";import{C as Ne}from"../chunks/CL_mTQmm.js";import{N as Ee}from"../chunks/NPevBcaT.js";import{N as Ve}from"../chunks/x_khJbtH.js";import{B as Me}from"../chunks/CVyulMm_.js";import{u as Ge}from"../chunks/B7bmE7Iz.js";import{u as se}from"../chunks/T3uKKWzz.js";import{O as Oe}from"../chunks/99krErCG.js";import{p as Y,r as Be}from"../chunks/D54UoLP7.js";import{B as Q,t as te,s as re}from"../chunks/BaLU91-Z.js";import{y as ye}from"../chunks/Cx6cA6Ki.js";import{I as Re}from"../chunks/COZs6rVX.js";import{L as Fe}from"../chunks/BlWtnSFg.js";import{I as ae}from"../chunks/BSsA32Jj.js";import{I as xe}from"../chunks/AGQ0LC6s.js";import{u as le}from"../chunks/pXVVLMtZ.js";import{f as oe,a as fe}from"../chunks/HguhFfd2.js";import{k as pe}from"../chunks/CR-rXziN.js";import{h as ue}from"../chunks/CP6_I6cz.js";import{c as Ue}from"../chunks/B3Y-rhQz.js";import{I as qe}from"../chunks/BhHxAx3w.js";import{a as je,b as He,I as Ye}from"../chunks/BFELTQEF.js";import{T as We}from"../chunks/Uvg4PFWU.js";import{I as Je}from"../chunks/DVvDmFQc.js";import{k as Qe}from"../chunks/DzmDou2k.js";import{F as Xe}from"../chunks/BHicDA9d.js";var Ze=L('<div class="center svelte-opxw4z"><!></div>'),et=L("<div><!></div>"),tt=L('<div class="row svelte-opxw4z"><!> <div class="center svelte-opxw4z"><!></div> <div class="center svelte-opxw4z"><!></div> <div class="center svelte-opxw4z"><!></div> <div class="center svelte-opxw4z"><!></div></div>'),rt=L('<div class="matrix svelte-opxw4z"><div class="row svelte-opxw4z"><div></div> <!> <!> <!> <!></div> <!></div>');function be(V,i){X(i,!0),Y(i,"finalize",15)(C);let o=j([["Blacklist",!1,!1,!1,!1],["Clients",!1,!1,!1,!1],["Events",!1,!1,!1,!1],["Generic",!1,!1,!1,!1],["Groups",!1,!1,!1,!1],["Roles",!1,!1,!1,!1],["Secrets",!1,!1,!1,!1],["Sessions",!1,!1,!1,!1],["Scopes",!1,!1,!1,!1],["UserAttributes",!1,!1,!1,!1],["Users",!1,!1,!1,!1]]);W(()=>{if(d(),i.key)for(let m of i.key.access){let t;switch(m.group){case"Blacklist":t=0;break;case"Clients":t=1;break;case"Events":t=2;break;case"Generic":t=3;break;case"Groups":t=4;break;case"Roles":t=5;break;case"Secrets":t=6;break;case"Sessions":t=7;break;case"Scopes":t=8;break;case"UserAttributes":t=9;break;case"Users":t=10;break}if(t===void 0){console.error("invalid idx during access key buildup");return}m.access_rights.includes("create")&&(o[t][1]=!0),m.access_rights.includes("read")&&(o[t][2]=!0),m.access_rights.includes("update")&&(o[t][3]=!0),m.access_rights.includes("delete")&&(o[t][4]=!0)}});function C(){let m=[];for(let t of o){let l=[];t[1]&&l.push("create"),t[2]&&l.push("read"),t[3]&&l.push("update"),t[4]&&l.push("delete"),l.length>0&&m.push({group:t[0],access_rights:l})}return m}function d(){for(let m of o)m[1]=!1,m[2]=!1,m[3]=!1,m[4]=!1}function x(m){for(let t of o)if(t[0]===m){t[1]&&t[2]&&t[3]&&t[4]?(t[1]=!1,t[2]=!1,t[3]=!1,t[4]=!1):(t[1]=!0,t[2]=!0,t[3]=!0,t[4]=!0);break}}function y(m){let t;switch(m){case"create":t=1;break;case"read":t=2;break;case"update":t=3;break;case"delete":t=4;break}if(!t){console.error("logic error in toggleRight, idx is undefined");return}let l=!0;for(let p of o)if(!p[t]){l=!1;break}for(let p of o)p[t]=!l}var A=rt();{const m=(l,p=me)=>{var _=Ze(),h=v(_);const g=F(()=>`Toggle: ${p()}`);Q(h,{get ariaLabel(){return e(g)},invisible:!0,onclick:()=>y(p()),children:(w,u)=>{B();var r=U();D(()=>E(r,p())),k(w,r)},$$slots:{default:!0}}),n(_),k(l,_)},t=(l,p=me)=>{var _=et(),h=v(_);const g=F(()=>`Toggle: ${p()}`);Q(h,{get ariaLabel(){return e(g)},invisible:!0,onclick:()=>x(p()),children:(w,u)=>{B();var r=U();D(()=>E(r,p())),k(w,r)},$$slots:{default:!0}}),n(_),k(l,_)};var b=v(A),P=c(v(b),2);m(P,()=>"create");var K=c(P,2);m(K,()=>"read");var $=c(K,2);m($,()=>"update");var I=c($,2);m(I,()=>"delete"),n(b);var S=c(b,2);he(S,17,()=>o,Te,(l,p,_)=>{var h=tt(),g=v(h);t(g,()=>e(p)[0]);var w=c(g,2),u=v(w);const r=F(()=>`${e(p)[0]}: create`);ae(u,{get ariaLabel(){return e(r)},get checked(){return o[_][1]},set checked(q){o[_][1]=q}}),n(w);var a=c(w,2),f=v(a);const z=F(()=>`${e(p)[0]}: read`);ae(f,{get ariaLabel(){return e(z)},get checked(){return o[_][2]},set checked(q){o[_][2]=q}}),n(a);var G=c(a,2),O=v(G);const M=F(()=>`${e(p)[0]}: update`);ae(O,{get ariaLabel(){return e(M)},get checked(){return o[_][3]},set checked(q){o[_][3]=q}}),n(G);var H=c(G,2),ee=v(H);const ie=F(()=>`${e(p)[0]}: delete`);ae(ee,{get ariaLabel(){return e(ie)},get checked(){return o[_][4]},set checked(q){o[_][4]=q}}),n(H),n(h),k(l,h)}),n(A)}k(V,A),Z()}var at=L("<div><!></div>"),st=L('<div class="err"> </div>'),it=L('<!> <!> <!> <!> <div class="btn svelte-1j50zcx"><!> <!> <!></div>',1);function ot(V,i){X(i,!0);let N=le(),o=se();const C=oe();let d=T(""),x=T(!1),y=T(!!i.key.expires),A=T(j(oe())),b=T(j(fe())),P=T(void 0);W(()=>{i.key.name&&s(y,!!i.key.expires)}),W(()=>{if(e(y)){let r;i.key.expires?r=new Date(i.key.expires*1e3):r=new Date,s(A,oe(r),!0),s(b,fe(r),!0)}});async function K(){if(s(d,""),!e(P)){console.error("finalizeMatrix is undefined");return}let r={name:i.key.name,access:e(P)()};if(r.access.length===0){s(d,"Grant the API Key at least one permission");return}if(e(y)){let f=ye(e(A),e(b));if(!f){s(d,"Invalid Date Input: User Expires");return}r.exp=f}let a=await ke(`/auth/v1/api_keys/${i.key.name}`,r);a.error?s(d,a.error.message,!0):(i.onSave(),s(x,!0),setTimeout(()=>{s(x,!1),i.onSave()},2e3))}var $=it(),I=J($);Fe(I,{get label(){return o.api_key.keyName},children:(r,a)=>{B();var f=U();D(()=>E(f,i.key.name)),k(r,f)},$$slots:{default:!0}});var S=c(I,2);ae(S,{get ariaLabel(){return o.api_key.limitedValidity},get checked(){return e(y)},set checked(r){s(y,r,!0)},children:(r,a)=>{B();var f=U();D(()=>E(f,o.api_key.limitedValidity)),k(r,f)},$$slots:{default:!0}});var m=c(S,2);{var t=r=>{var a=at(),f=v(a);xe(f,{get label(){return o.api_key.expires},withTime:!0,min:C,required:!0,get value(){return e(A)},set value(z){s(A,z,!0)},get timeValue(){return e(b)},set timeValue(z){s(b,z,!0)}}),n(a),te(3,a,()=>re,()=>({duration:150})),k(r,a)};R(m,r=>{e(y)&&r(t)})}var l=c(m,2);be(l,{get key(){return i.key},get finalize(){return e(P)},set finalize(r){s(P,r,!0)}});var p=c(l,2),_=v(p);Q(_,{onclick:K,children:(r,a)=>{B();var f=U();D(()=>E(f,N.common.save)),k(r,f)},$$slots:{default:!0}});var h=c(_,2);{var g=r=>{Re(r,{})};R(h,r=>{e(x)&&r(g)})}var w=c(h,2);{var u=r=>{var a=st(),f=v(a,!0);n(a),D(()=>E(f,e(d))),k(r,a)};R(w,r=>{e(d)&&r(u)})}n(p),k(V,$),Z()}var lt=L("<div><!></div>"),nt=L("<div><!></div>"),dt=L("<div><!></div>"),vt=L('<div><div class="iconsOuter svelte-1pc4fk7"><div class="iconsInner svelte-1pc4fk7"><!> <!></div></div> <textarea></textarea></div>');function _e(V,i){X(i,!0);let N=Y(i,"ariaLabel",3,""),o=Y(i,"value",3,""),C=Y(i,"rows",3,10),d=Y(i,"cols",3,60),x=Y(i,"show",15,!1),y=Y(i,"width",3,"min(25rem, calc(100dvw - .5rem))"),A=Be(i,["$$slots","$$events","$$legacy","ariaLabel","value","rows","cols","show","width"]),b=le(),P=T(""),K=T("");W(()=>{x()?s(K,o()):s(K,e(P),!0)}),ge(()=>{for(let u=0;u<o().length;u++)s(P,e(P)+"*");s(K,e(P),!0),x(!1)});function $(){navigator.clipboard.writeText(o())}function I(){x(!x())}var S=vt();let m;var t=v(S),l=v(t),p=v(l);const _=F(()=>x()?b.common.hide:b.common.show);Q(p,{get ariaLabel(){return e(_)},invisible:!0,onclick:I,children:(u,r)=>{var a=Pe(),f=J(a);{var z=O=>{var M=lt(),H=v(M);je(H,{width:22}),n(M),D(()=>ne(M,"title",b.common.hide)),k(O,M)},G=O=>{var M=nt(),H=v(M);He(H,{width:22}),n(M),D(()=>ne(M,"title",b.common.show)),k(O,M)};R(f,O=>{x()?O(z):O(G,!1)})}k(u,a)},$$slots:{default:!0}});var h=c(p,2);Q(h,{get ariaLabel(){return b.common.copyToClip},invisible:!0,onclick:$,children:(u,r)=>{var a=dt(),f=v(a);qe(f,{}),n(a),D(()=>ne(a,"title",b.common.copyToClip)),k(u,a)},$$slots:{default:!0}}),n(l),n(t);var g=c(t,2);Se(g);let w;n(S),D(()=>{m=Ae(S,"",m,{width:`${y()}`}),w=ze(g,w,{"aria-label":N(),disabled:!0,rows:C(),cols:d(),...A,[Ce]:{width:y(),"padding-right":"2.75rem"}},"svelte-1pc4fk7")}),Ue(g,()=>e(K),u=>s(K,u)),k(V,S),Z()}var ct=L('<div class="secret font-mono svelte-1ii2aob"><!></div> <div><p><!></p> <p><span class="headerCode"><b><code></code></b></span></p></div> <div><p><!></p> <!></div> <div><p><!></p> <!></div>',1),ut=L('<p> </p> <p> </p> <div class="btn svelte-1ii2aob"><!></div> <!> <div class="err"> </div>',1);function ft(V,i){X(i,!0);let N=le(),o=se(),C=T(""),d=T(""),x=T(""),y=T("");W(()=>{i.key.name&&s(d,"")});async function A(){let g=await ke(`/auth/v1/api_keys/${i.key.name}/secret`);g.text?(s(d,g.text,!0),s(x,`curl -s -H 'Authorization: API-Key ${g.text}' ${window.location.origin}/auth/v1/api_keys/${i.key.name}/test`),s(y,`${e(x)} | jq`)):s(C,g.error?.message||"Error",!0)}var b=ut(),P=J(b),K=v(P,!0);n(P);var $=c(P,2),I=v($,!0);n($);var S=c($,2),m=v(S);const t=F(()=>e(d)?3:1);Q(m,{get level(){return e(t)},onclick:A,children:(g,w)=>{B();var u=U();D(()=>E(u,N.passwordReset.generate)),k(g,u)},$$slots:{default:!0}}),n(S);var l=c(S,2);{var p=g=>{var w=ct(),u=J(w),r=v(u);Ye(r,{autocomplete:"off",get value(){return e(d)},label:"API Key",placeholder:"API Key",disabled:!0,showCopy:!0,width:"min(25rem, calc(100dvw - .5rem))"}),n(u);var a=c(u,2),f=v(a),z=v(f);ue(z,()=>o.api_key.generate3),n(f);var G=c(f,2),O=v(G),M=v(O),H=v(M);H.textContent="API-Key <api_key>",n(M),n(O),n(G),n(a);var ee=c(a,2),ie=v(ee),q=v(ie);ue(q,()=>o.api_key.generate4),n(ie);var we=c(ie,2);pe(we,()=>e(y),ce=>{_e(ce,{ariaLabel:"curl text command with jq",rows:5,get value(){return e(y)}})}),n(ee);var de=c(ee,2),ve=v(de),$e=v(ve);ue($e,()=>o.api_key.generate5),n(ve);var Ie=c(ve,2);pe(Ie,()=>e(y),ce=>{_e(ce,{ariaLabel:"curl text command simple",rows:5,get value(){return e(x)}})}),n(de),te(3,u,()=>re,()=>({duration:150})),te(3,a,()=>re,()=>({duration:150})),te(3,ee,()=>re,()=>({duration:150})),te(3,de,()=>re,()=>({duration:150})),k(g,w)};R(l,g=>{e(d)&&g(p)})}var _=c(l,2),h=v(_,!0);n(_),D(()=>{E(K,o.api_key.generate1),E(I,o.api_key.generate2),E(h,e(C))}),k(V,b),Z()}var mt=L('<div class="err"> </div>'),pt=L("<p> </p> <!> <!>",1);function _t(V,i){X(i,!0);let N=le(),o=se(),C=T("");async function d(){s(C,"");let $=await Le(`/auth/v1/api_keys/${i.key.name}`);$.error?s(C,$.error.message,!0):i.onSave()}var x=pt(),y=J(x),A=v(y,!0);n(y);var b=c(y,2);Q(b,{level:-1,onclick:d,children:($,I)=>{B();var S=U();D(()=>E(S,N.common.delete)),k($,S)},$$slots:{default:!0}});var P=c(b,2);{var K=$=>{var I=mt(),S=v(I,!0);n(I),D(()=>E(S,e(C))),k($,I)};R(P,$=>{e(C)&&$(K)})}D(()=>E(A,o.api_key.delete1)),k(V,x),Z()}var gt=L('<div><div class="flex"><!></div> <!></div>');function ht(V,i){X(i,!0);let N=Y(i,"key",15),o=se();const C=[o.tabs.config,"Secret",o.tabs.delete];let d=T(j(C[0])),x=T(void 0);W(()=>{N().name&&e(x)?.()});var y=gt(),A=v(y),b=v(A);We(b,{tabs:C,get selected(){return e(d)},set selected(I){s(d,I,!0)},get focusFirst(){return e(x)},set focusFirst(I){s(x,I,!0)}}),n(A);var P=c(A,2);{var K=I=>{ot(I,{get onSave(){return i.onSave},get key(){return N()},set key(S){N(S)}})},$=(I,S)=>{{var m=l=>{ft(l,{get key(){return N()}})},t=(l,p)=>{{var _=h=>{_t(h,{get key(){return N()},get onSave(){return i.onSave}})};R(l,h=>{e(d)===o.tabs.delete&&h(_)},p)}};R(I,l=>{e(d)==="Secret"?l(m):l(t,!1)},S)}};R(P,I=>{e(d)===o.tabs.config?I(K):I($,!1)})}n(y),k(V,y),Z()}var kt=L("<div><!></div>"),yt=L('<!> <!> <!> <!> <!> <div class="err"> </div>',1),xt=L('<div class="container svelte-1dweyfr"><!></div>');function bt(V,i){X(i,!0);const N=oe();let o=le(),C=se(),d=T(""),x=T(!1),y=T(void 0),A=T(""),b=T(j(oe())),P=T(j(fe()));async function K(S,m){s(d,"");for(let _ of i.keys)if(_.name===e(A)){s(d,"Name already exists");return}let t=e(y)?.();if(!t){console.error("access rights is undefined");return}let l={name:e(A),access:t};if(l.access.length===0){s(d,"Grant the new API Key at least one permission");return}if(e(x)){if(console.log(),!e(b)||!e(P)){s(d,"Disable expiry or provide an valid date and time");return}let _=ye(e(b),e(P));if(!_){s(d,"Invalid Date Input: User Expires");return}l.exp=_}let p=await Ke(S.action,l);p.error?s(d,p.error.message,!0):i.onSave()}var $=xt(),I=v($);Xe(I,{action:"/auth/v1/api_keys",onSubmit:K,children:(S,m)=>{var t=yt(),l=J(t);Je(l,{get label(){return C.api_key.keyName},get placeholder(){return C.api_key.keyName},autocomplete:"off",required:!0,min:"2",max:"24",pattern:Qe,get value(){return e(A)},set value(a){s(A,a,!0)}});var p=c(l,2);ae(p,{get ariaLabel(){return C.api_key.limitedValidity},get checked(){return e(x)},set checked(a){s(x,a,!0)},children:(a,f)=>{B();var z=U();D(()=>E(z,C.api_key.limitedValidity)),k(a,z)},$$slots:{default:!0}});var _=c(p,2);{var h=a=>{var f=kt(),z=v(f);xe(z,{get label(){return C.api_key.expires},withTime:!0,min:N,required:!0,get value(){return e(b)},set value(G){s(b,G,!0)},get timeValue(){return e(P)},set timeValue(G){s(P,G,!0)}}),n(f),te(3,f,()=>re,()=>({duration:150})),k(a,f)};R(_,a=>{e(x)&&a(h)})}var g=c(_,2);be(g,{get finalize(){return e(y)},set finalize(a){s(y,a,!0)}});var w=c(g,2);Q(w,{type:"submit",children:(a,f)=>{B();var z=U();D(()=>E(z,o.common.save)),k(a,z)},$$slots:{default:!0}});var u=c(w,2),r=v(u,!0);n(u),D(()=>E(r,e(d))),k(S,t)},$$slots:{default:!0}}),n($),k(V,$),Z()}var wt=L('<div class="keysList svelte-1x72cde"></div>'),$t=L("<!> <!>",1),It=L('<div id="keys"><!></div>'),Pt=L(" <!> <!>",1);function St(V,i){X(i,!0);let N=se(),o=T(void 0),C=T(""),d=T(j([])),x=T(j([])),y=T(void 0),A=Ge("kn");const b=["Name"],P=["Name"];let K=T(j(P[0])),$=T("");ge(()=>{I()}),W(()=>{s(y,e(d).find(h=>h.name===A.get()),!0)}),W(()=>{let h=e($).toLowerCase();h?e(K)===P[0]&&s(x,e(d).filter(g=>g.name?.includes(h)),!0):s(x,e(d),!0)});async function I(){let h=await De("/auth/v1/api_keys");h.body?s(d,h.body.keys,!0):s(C,h.error?.message||"Error",!0)}function S(h,g){let w=g==="up";h===b[0]&&e(d).sort((u,r)=>w?u.name.localeCompare(r.name):r.name.localeCompare(u.name))}function m(){e(o)?.(),I()}B();var t=Pt(),l=J(t),p=c(l);Ve(p,{paddingTop:"2.1rem",buttonTilesAriaControls:"keys",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:g=>{var w=wt();he(w,21,()=>e(x),u=>u.name,(u,r,a,f)=>{const z=F(()=>A.get()===e(r).name);Ee(u,{onclick:()=>A.set(e(r).name),get selected(){return e(z)},children:(G,O)=>{B();var M=U();D(()=>E(M,e(r).name)),k(G,M)}})}),n(w),k(g,w)},children:(g,w)=>{var u=$t(),r=J(u);const a=F(()=>e(d).length===0?1:2);Me(r,{get level(){return e(a)},alignRight:!0,get closeModal(){return e(o)},set closeModal(z){s(o,z,!0)},children:(z,G)=>{bt(z,{get keys(){return e(d)},onSave:m})},$$slots:{default:!0}});var f=c(r,2);Oe(f,{searchOptions:P,orderOptions:b,onChangeOrder:S,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(K)},set searchOption(z){s(K,z,!0)},get value(){return e($)},set value(z){s($,z,!0)}}),k(g,u)},$$slots:{buttonTiles:!0,default:!0}});var _=c(p,2);Ne(_,{children:(h,g)=>{var w=It(),u=v(w);{var r=a=>{ht(a,{onSave:I,get key(){return e(y)},set key(f){s(y,f,!0)}})};R(u,a=>{e(y)&&a(r)})}n(w),D(()=>ne(w,"aria-label",N.common.details)),k(h,w)}}),D(()=>E(l,`${e(C)??""} `)),k(V,t),Z()}function or(V){St(V,{})}export{or as component};
