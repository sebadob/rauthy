import{t as S,e as R,a as d}from"../chunks/DVyqXkF9.js";import{p as z,a6 as V,f as E,l as n,k as g,j as e,s as w,t as I,c as B,a as U,a4 as j,r as O,a2 as q,a5 as X,a1 as te}from"../chunks/DXTz3Rbt.js";import{s as F}from"../chunks/BLUcFBb0.js";import{i as k}from"../chunks/Dnzfvyee.js";import{e as oe}from"../chunks/Dus-q-Em.js";import{u as W}from"../chunks/T3uKKWzz.js";import{B as ae}from"../chunks/CVyulMm_.js";import{C as se}from"../chunks/CL_mTQmm.js";import{N as ne}from"../chunks/NPevBcaT.js";import{N as ie}from"../chunks/x_khJbtH.js";import{O as ue}from"../chunks/99krErCG.js";import{b as le,g as de,d as ve,f as me}from"../chunks/DMieIo7a.js";import{u as ce}from"../chunks/21dMcSbF.js";import{B as Y}from"../chunks/BaLU91-Z.js";import{I as Z}from"../chunks/DxMCa-Hz.js";import{f as ee}from"../chunks/DzmDou2k.js";import{F as re}from"../chunks/BkyS6Cp-.js";import{u as Q}from"../chunks/pXVVLMtZ.js";import{T as fe}from"../chunks/Uvg4PFWU.js";import{I as ge}from"../chunks/COZs6rVX.js";import{L as pe}from"../chunks/BlWtnSFg.js";var _e=S('<div class="err"> </div>'),he=S("<!> <!> <!>",1),xe=S('<div class="container svelte-s1196z"><!></div>');function be(C,o){z(o,!0);let $=Q(),m=W(),u=g(void 0),a=g(""),i=g("");V(()=>{requestAnimationFrame(()=>{e(u)?.focus()})});async function h(x,b){if(o.groups.find(v=>v.name===e(i))){n(a,m.common.nameExistsAlready,!0);return}n(a,"");let s={group:e(i)},r=await le(x.action,s);r.body?o.onSave(r.body.id):n(a,r.error?.message||"Error",!0)}var c=xe(),p=B(c);re(p,{action:"/auth/v1/groups",onSubmit:h,children:(x,b)=>{var s=he(),r=E(s);Z(r,{autocomplete:"off",get label(){return m.groups.name},get placeholder(){return m.groups.name},required:!0,pattern:ee,get ref(){return e(u)},set ref(y){n(u,y,!0)},get value(){return e(i)},set value(y){n(i,y,!0)}});var v=w(r,2);Y(v,{type:"submit",children:(y,N)=>{j();var L=R();I(()=>F(L,$.common.save)),d(y,L)},$$slots:{default:!0}});var D=w(v,2);{var G=y=>{var N=_e(),L=B(N,!0);O(N),I(()=>F(L,e(a))),d(y,N)};k(D,y=>{e(a)&&y(G)})}d(x,s)},$$slots:{default:!0}}),O(c),d(C,c),U()}var ye=S('<div class="err"> </div>'),Pe=S('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Se(C,o){z(o,!0);let $=Q(),m=W(),u=g(""),a=g(!1),i=g(q(o.group.name));V(()=>{o.group.id&&n(i,o.group.name,!0)});async function h(p,x){if(n(u,""),e(i)!==o.group.name&&o.groups.find(r=>r.name===e(i))){n(u,m.common.nameExistsAlready,!0);return}let b={group:e(i)},s=await de(p.action,b);s.error?n(u,s.error.message,!0):(n(a,!0),o.onSave(),setTimeout(()=>{n(a,!1)},2e3))}const c=X(()=>`/auth/v1/groups/${o.group.id}`);re(C,{get action(){return e(c)},onSubmit:h,children:(p,x)=>{var b=Pe(),s=E(b);pe(s,{label:"ID",mono:!0,children:(t,f)=>{j();var l=R();I(()=>F(l,o.group.id)),d(t,l)},$$slots:{default:!0}});var r=w(s,2);Z(r,{autocomplete:"off",get label(){return m.groups.name},get placeholder(){return m.groups.name},width:"14.5rem",required:!0,pattern:ee,get value(){return e(i)},set value(t){n(i,t,!0)}});var v=w(r,2),D=B(v);Y(D,{type:"submit",children:(t,f)=>{j();var l=R();I(()=>F(l,$.common.save)),d(t,l)},$$slots:{default:!0}});var G=w(D,2);{var y=t=>{ge(t,{})};k(G,t=>{e(a)&&t(y)})}O(v);var N=w(v,2);{var L=t=>{var f=ye(),l=B(f,!0);O(f),I(()=>F(l,e(u))),d(t,f)};k(N,t=>{e(u)&&t(L)})}d(p,b)},$$slots:{default:!0}}),U()}var we=S('<div class="err"> </div>'),Ce=S("<p> </p> <!> <!>",1);function $e(C,o){z(o,!0);let $=Q(),m=W(),u=g("");async function a(){n(u,"");let s=await ve(`/auth/v1/groups/${o.group.id}`);s.error?n(u,s.error.message,!0):o.onSave()}var i=Ce(),h=E(i),c=B(h,!0);O(h);var p=w(h,2);Y(p,{level:-1,onclick:a,children:(s,r)=>{j();var v=R();I(()=>F(v,$.common.delete)),d(s,v)},$$slots:{default:!0}});var x=w(p,2);{var b=s=>{var r=we(),v=B(r,!0);O(r),I(()=>F(v,e(u))),d(s,r)};k(x,s=>{e(u)&&s(b)})}I(()=>F(c,m.groups.delete1)),d(C,i),U()}var Ae=S('<div class="flex"><!></div> <!>',1);function Te(C,o){z(o,!0);let $=Q(),m=W();const u=[m.nav.config,$.common.delete];let a=g(q(u[0])),i=g(void 0);V(()=>{o.group.id&&requestAnimationFrame(()=>{e(i)?.()})});var h=Ae(),c=E(h),p=B(c);fe(p,{tabs:u,get selected(){return e(a)},set selected(r){n(a,r,!0)},get focusFirst(){return e(i)},set focusFirst(r){n(i,r,!0)}}),O(c);var x=w(c,2);{var b=r=>{Se(r,{get group(){return o.group},get groups(){return o.groups},get onSave(){return o.onSave}})},s=(r,v)=>{{var D=G=>{$e(G,{get group(){return o.group},get onSave(){return o.onSave}})};k(r,G=>{e(a)===$.common.delete&&G(D)},v)}};k(x,r=>{e(a)===m.nav.config?r(b):r(s,!1)})}d(C,h),U()}var Ie=S('<div class="groupsList svelte-mhhlpi"></div>'),Oe=S("<!> <!>",1),Fe=S('<div class="err"> </div>'),Ge=S('<!> <div id="groups"><!></div>',1),Ne=S("<!> <!>",1);function Be(C,o){z(o,!0);let $=W(),m=g(void 0),u=g(""),a=g(q([])),i=g(q([])),h=g(void 0),c=ce("gid");const p=[$.common.name,"ID"];let x=g(q(p[0])),b=g("");const s=[$.common.name,"ID"];te(()=>{r()}),V(()=>{n(h,e(a).find(t=>t.id===c.get()),!0)}),V(()=>{let t=e(b).toLowerCase();t?e(x)===p[0]?n(i,e(a).filter(f=>f.name?.toLowerCase().includes(t)),!0):e(x)===p[1]&&n(i,e(a).filter(f=>f.id.toLowerCase().includes(t)),!0):n(i,e(a),!0)});async function r(){let t=await me("/auth/v1/groups");t.body?n(a,t.body,!0):n(u,t.error?.message||"Error",!0)}function v(t,f){let l=f==="up";t===s[0]?e(a).sort((_,P)=>l?_.name.localeCompare(P.name):P.name.localeCompare(_.name)):t===s[1]&&e(a).sort((_,P)=>l?_.id.localeCompare(P.id):P.id.localeCompare(_.id))}function D(){r()}async function G(t){e(m)?.(),await r(),c.set(t)}var y=Ne(),N=E(y);ie(N,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:f=>{var l=Ie();oe(l,21,()=>e(i),_=>_.id,(_,P,M,H)=>{const A=X(()=>c.get()===e(P).id);ne(_,{onclick:()=>c.set(e(P).id),get selected(){return e(A)},children:(T,J)=>{j();var K=R();I(()=>F(K,e(P).name)),d(T,K)}})}),O(l),d(f,l)},children:(f,l)=>{var _=Oe(),P=E(_);const M=X(()=>e(a).length===0?1:2);ae(P,{get level(){return e(M)},alignRight:!0,get closeModal(){return e(m)},set closeModal(A){n(m,A,!0)},children:(A,T)=>{be(A,{onSave:G,get groups(){return e(a)}})},$$slots:{default:!0}});var H=w(P,2);ue(H,{searchOptions:p,orderOptions:s,onChangeOrder:v,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(x)},set searchOption(A){n(x,A,!0)},get value(){return e(b)},set value(A){n(b,A,!0)}}),d(f,_)},$$slots:{buttonTiles:!0,default:!0}});var L=w(N,2);se(L,{children:(t,f)=>{var l=Ge(),_=E(l);{var P=T=>{var J=Fe(),K=B(J,!0);O(J),I(()=>F(K,e(u))),d(T,J)};k(_,T=>{e(u)&&T(P)})}var M=w(_,2),H=B(M);{var A=T=>{Te(T,{get group(){return e(h)},get groups(){return e(a)},onSave:D})};k(H,T=>{e(h)&&T(A)})}O(M),d(t,l)}}),d(C,y),U()}function tr(C){Be(C,{})}export{tr as component};
