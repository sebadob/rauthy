import{t as v,a as i,e as j}from"../chunks/DVyqXkF9.js";import{p as se,a1 as ie,f as M,a as ne,s as t,l as s,k as l,c as o,j as r,r as a,a4 as P,t as de}from"../chunks/DXTz3Rbt.js";import{s as A}from"../chunks/BLUcFBb0.js";import{i as x}from"../chunks/Dnzfvyee.js";import{B as E}from"../chunks/BaLU91-Z.js";import{I as K}from"../chunks/DxMCa-Hz.js";import{C as N}from"../chunks/CdgZ0Q70.js";import{M as le}from"../chunks/BdLPQyv5.js";import{C as ve}from"../chunks/DrM_mJzu.js";import{a as z}from"../chunks/DzmDou2k.js";import{F as ce}from"../chunks/BkyS6Cp-.js";import{g as pe}from"../chunks/Cx6cA6Ki.js";var ue=v("<br>-> enable idp registration:<br> <code>chrome://flags/#fedcm-idp-registration</code>",1),fe=v("<p><!> <!> <!></p>"),ge=v('<p><!></p> <!> <div class="row svelte-wuqbvo"><b>Logged In:</b> <div class="check svelte-wuqbvo"><!></div></div>',1),me=v('<div class="flex-col"><h1>FedCM Testing</h1> <div class="row svelte-wuqbvo"><div><b>FedCM supported:</b></div> <div class="check svelte-wuqbvo"><!></div></div> <!> <!></div>'),_e=v('<div class="row svelte-wuqbvo"><b>Credential Type:</b> <span> </span></div> <div class="token svelte-wuqbvo"> </div>',1),he=v("<!> <!>",1);function Re(G,H){se(H,!0);let m=l(!1),$=l(!1),w=l(""),F=l(""),_=l("fedcm"),c=l("any");ie(async()=>{s(c,`${window.location.origin}/auth/v1/fed_cm/config`),s(_,`${window.location.origin}/auth/v1/fed_cm/client_config`),(await fetch("/auth/v1/fed_cm/status")).status===200?(console.log("FedCM status is: logged-in"),s($,!0)):console.log("FedCM status is: logged-out"),window.IdentityProvider&&IdentityProvider.register!=null?(console.log("FedCM is supported"),s(m,!0)):console.error("FedCM is not supported")});async function J(){try{let e=await navigator.credentials.get({identity:{mode:"button",providers:[{configURL:r(c),clientId:r(_),nonce:pe(48)}]}});console.log(e),s(F,e.type,!0),s(w,e.token,!0),s($,!0)}catch(e){console.error("FedCM credentials error: "+e)}}function O(){IdentityProvider.register(r(c))}var q=he(),L=M(q);le(L,{children:(e,C)=>{ve(e,{children:(p,I)=>{var u=me(),d=t(o(u),2),h=t(o(d),2),W=o(h);N(W,{get check(){return r(m)}}),a(h),a(d);var R=t(d,2);{var X=n=>{var b=ue();P(4),i(n,b)};x(R,n=>{r(m)||n(X)})}var Y=t(R,2);{var Z=n=>{var b=ge(),y=M(b),ee=o(y);E(ee,{onclick:O,level:2,children:(k,re)=>{P();var f=j("Register IdP");i(k,f)},$$slots:{default:!0}}),a(y);var T=t(y,2);ce(T,{action:"",onSubmit:J,children:(k,re)=>{var f=fe(),D=o(f);K(D,{autocomplete:"off",label:"Client ID",placeholder:"Client ID",required:!0,pattern:z,get value(){return r(_)},set value(g){s(_,g,!0)}});var S=t(D,2);K(S,{autocomplete:"off",label:"Config URL",placeholder:"Config URL",pattern:z,get value(){return r(c)},set value(g){s(c,g,!0)}});var oe=t(S,2);E(oe,{type:"submit",children:(g,be)=>{P();var ae=j("Login");i(g,ae)},$$slots:{default:!0}}),a(f),i(k,f)},$$slots:{default:!0}});var U=t(T,2),B=t(o(U),2),te=o(B);N(te,{get check(){return r($)}}),a(B),a(U),i(n,b)};x(Y,n=>{r(m)&&n(Z)})}a(u),i(p,u)}})}});var Q=t(L,2);{var V=e=>{var C=_e(),p=M(C),I=t(o(p),2),u=o(I,!0);a(I),a(p);var d=t(p,2),h=o(d,!0);a(d),de(()=>{A(u,r(F)),A(h,r(w))}),i(e,C)};x(Q,e=>{r(w)&&e(V)})}i(G,q),ne()}export{Re as component};
